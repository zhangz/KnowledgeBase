## API Gateway
Gateway是微服务对外提供服务的一个屏障，它的核心点在于：
- 屏蔽微服务之间通过消息队列、rpc等通信方式，为Web页面和移动APP提供基于HTTP协议的RESTful API接口
- 对每一个http业务请求进行必要的鉴权和数据完整性、合法性检查，以减少微服务的负担，让微服务的代码更纯粹
- 微服务部署体系中，每个微服务可能会部署多个实例，Gateway还承担着在这些实例中进行负载均衡的功能
- 进行必要的日志输出、监控打点等功能，对每一个来自于APP和页面的http请求，生成一个唯一的trace id，并将trace id传导到每一个后续的微服务中，以便后续的查错和性能调优
- Gateway的每一个http请求都是无状态的，采用JWT（Json Web Token）机制实现一个客户端的请求状态信息的传递

## 服务的注册与发现
微服务体系中，服务的注册和发现对整体架构非常重要，尤其对于同步的rpc调用，每个服务有多少实例，每个实例的地址等，都需要有一个统一的管理。

## 服务调用方式
- 同步调用
- 异步调用：可以避免线程阻塞，提升系统的吞吐量和可靠性
- 并行调用：适用于多个服务调用没有上下文依赖，逻辑上可以并行处理，并行服务调用涉及到同步转异步、异步转同步、结果汇聚等。采用并行服务调用，可以把传统串行的服务调用优化成并行处理，能够极大的缩短服务调用时延。

## 事务一致性
大部分业务可以通过最终一致性来解决，极少部分需要采用强一致性。最终一致性，可以基于消息中间件实现。

## 微服务的性能三要素
- I/O模型。通常会选用非堵塞的。 异步非阻塞I/O
- 线程调度模型。
- 序列化方式。二进制序列化（Thrift，protobuf等）

## RPC框架职责
client端：序列化、反序列化、连接池管理、负载均衡、故障转移、队列管理，超时管理、异步管理等等职责。
server端：服务端组件、服务端收发包队列、io线程、工作线程、序列化反序列化、上下文管理器、超时管理、异步回调等等职责。

## 序列化协议要考虑什么因素
- 解析效率：这个应该是序列化协议应该首要考虑的因素，像xml/json解析起来比较耗时，二进制自定义协议解析起来效率就很高
- 压缩率，传输有效性：同样一个对象，xml/json传输起来有大量的xml标签，信息有效性低，二进制自定义协议占用的空间相对来说就小多了
- 扩展性与兼容性：是否能够方便的增加字段，增加字段后旧版客户端是否需要强制升级，都是需要考虑的问题，xml/json和上面的二进制协议都能够方便的扩展
- 可读性与可调试性：这个很好理解，xml/json的可读性就比二进制协议好很多
- 跨语言：上面的两个协议都是跨语言的，有些序列化协议是与开发语言紧密相关的，例如dubbo的序列化协议就只能支持Java的RPC调用
- 通用性：xml/json非常通用，都有很好的第三方解析库，各个语言解析起来都十分方便，上面自定义的二进制协议虽然能够跨语言，但每个语言都要写一个简易的协议客户端


